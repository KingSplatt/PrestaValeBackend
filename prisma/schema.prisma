generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model client {
  clientid         Int                @id @default(autoincrement())
  name             String             @db.VarChar(255)
  creditbalance    Decimal?           @default(0.00) @db.Decimal(9, 2)
  commissionconfig commissionconfig[]
  voucher          voucher[]
}

model commissionconfig {
  configid   Int     @id @default(autoincrement())
  clientid   Int?
  day        Int
  percentage Decimal @db.Decimal(5, 2)
  client     client? @relation(fields: [clientid], references: [clientid], onDelete: Cascade, onUpdate: NoAction)

  @@index([clientid], map: "idx_commission_client")
}

model payment {
  paymentid   Int       @id @default(autoincrement())
  voucherid   Int?
  amount      Decimal   @db.Decimal(9, 2)
  paymentdate DateTime? @default(now()) @db.Timestamp(6)
  voucher     voucher?  @relation(fields: [voucherid], references: [voucherid], onDelete: Cascade, onUpdate: NoAction)

  @@index([voucherid], map: "idx_payment_voucher")
}

model voucher {
  voucherid   Int             @id @default(autoincrement())
  totalamount Decimal         @db.Decimal(9, 2)
  balance     Decimal         @db.Decimal(9, 2)
  status      voucher_status? @default(ACTIVE)
  createdat   DateTime?       @default(now()) @db.Timestamp(6)
  duedate     DateTime        @db.Timestamp(6)
  clientid    Int?
  payment     payment[]
  client      client?         @relation(fields: [clientid], references: [clientid], onDelete: Cascade, onUpdate: NoAction)

  @@index([clientid], map: "idx_voucher_client")
}

enum voucher_status {
  ACTIVE
  PAID
}
